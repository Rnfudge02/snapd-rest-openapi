# v2/paths/snaps.yaml

get:
  tags:
    - Open
    - Snaps
    - Sync
  summary: List installed snaps
  description: |-
    Lists snaps installed on the system, including their components.
  operationId: listInstalledSnaps
  security: []
  parameters:
    - name: select
      in: query
      description: Filter which revisions of snaps are returned.
      schema:
        type: string
        enum: [all, enabled, refresh-inhibited]
        default: enabled
    - name: snaps
      in: query
      description: A comma-separated list of snap names to filter by.
      schema:
        type: string
  responses:
    '200':
      description: A list of installed snaps matching the query.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '../components/schemas/InstalledSnap.yaml'
    '400':
      $ref: '../components/responses/BadRequest.yaml'

post:
  tags:
    - Async
    - Macaroon
    - Snaps
  summary: Manage snaps
  description: |-
    Install, refresh, revert, remove, enable, disable, or perform other actions on snaps.
    This endpoint supports both standard JSON requests for store operations and multipart/form-data for sideloading snaps.
  operationId: manageSnaps
  security:
    - macaroonAuth: []
  requestBody:
    description: The action to perform on one or more snaps.
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - action
          properties:
            action:
              type: string
              enum: [install, refresh, remove, revert, hold, unhold, enable, disable, switch, snapshot]
            snaps:
              type: array
              items:
                type: string
            # Add other JSON-based fields here...
      multipart/form-data:
        schema:
          type: object
          properties:
            action:
              type: string
              enum: [install, try]
              default: install
            snap:
              type: string
              format: binary
              description: The content of a .snap file.
            dangerous:
              type: boolean
            devmode:
              type: boolean
  responses:
    '202':
      $ref: '../components/responses/Accepted.yaml'
    '400':
      $ref: '../components/responses/BadRequest.yaml'